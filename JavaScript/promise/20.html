<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>构建扁平化setInterval</title>
  <style>
    div {
      width: 100px;
      height: 100px;
      background: yellowgreen;
      position: absolute;
    }

  </style>
</head>

<body>
  <div></div>
  <script>
    /*     function interval(delay = 1000, callback) {
      return new Promise(resolve => {
        let id = setInterval(() => {
          callback(id, resolve);
        }, delay);
      });
    }
    interval(100, (id, resolve) => {
        const div = document.querySelector("div");
        let left = parseInt(window.getComputedStyle(div).left);
        div.style.left = left + 10 + "px";
        if (left >= 200) {
          clearInterval(id);
          resolve(div);
        }
      })
      .then(div => {
        return interval(100, (id, resolve) => {
          let width = parseInt(window.getComputedStyle(div).width);
          div.style.width = width - 10 + "px";
          if (width <= 20) {
            clearInterval(id);
            resolve(div);
          }
        });
      })
      .then(div => {
        div.style.backgroundColor = "red";
      });
 */
    /* yznaisy */
    function interval(delay = 1000, callback) {
      return new Promise(resolve => {
        let id = setInterval(() => {
          callback(id, resolve);
        }, delay);
      })
    }
    interval(100, (id, resolve) => {
        let div = document.querySelector("div");
        let left = parseInt(window.getComputedStyle(div).left);
        div.style.left = left + 10 + "px "
        if (left >= 200) {
          clearInterval(id);
          resolve(div)
        }
        console.log(left);
        // clearInterval(id)
      }).then(div => {
        // console.log(width);
        return interval(100, (id, resolve) => {
          let width = parseInt(window.getComputedStyle(div).width);
          div.style.width = width - 10 + "px";
          if (width <= 20) {
            clearInterval(id);
            div.style.backgroundColor = "red"
            resolve(div)
          }
        })
      })
      .then(div => {
        interval(100, (id, resolve) => {
          let height = parseInt(window.getComputedStyle(div).height)
          div.style.height = height - 10 + "px";
          if (height <= 20) {
            clearInterval(id)
          }
        })

      })

  </script>
</body>


</html>
